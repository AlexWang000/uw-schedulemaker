# For TA
The files containing the SQL code used for creating tables, constraints, stored procedures and trigger can be found at `~/backend/database/sql`.
## Generating the production dataset
The production dataset is generated by doing many calls to the uWaterloo OpenAPI. To populate our local databases, we run the code in `backend/database/scripts/populate_tables.py`, which executes the API calls in `backend/database/scripts/util_get_waterloo_data.py`. Here is a summary of the steps: 
1. Get 10 courses from each subject at /courses.
2. Get the course description for each course at /course/{course_id}.
3. Get all classes for each course at /courses/{subject}/{catalog_number}. For each class time associated with a class, insert into ClassTime.

## Progress info
Current features:
- Users can select a range of dates and times, which will show all available classes in that date range and time period. See `frontend/src/components/classSearch.js`, `frontend/src/components/classList.js`.
- Users can view all the courses in all faculties and see the course descriptions, and filter them based on subject or course code. See `frontend/src/components/coursesSearch.js`, `frontend/src/components/coursesList.js`.
- Users can log in and view their profile. They add any courses that they have already taken. See `frontend/src/components/login.js`, `frontend/src/components/profile.js`.
- We can successfully retrieve production data from uWaterloo OpenAPI.
- Users are able to upload their schedule by copying it from Quest.

Future addition:
- The web app will show all the classes that they can take in their schedule's free slots. The following scenarios would cause a class to be ineligible:
    - The user has already taken the course.
    - The user is missing prerequisites.
    - The user is busy during the main lecture time.
    - The user is available during the main lecture time, but is busy during the related component time (like tutorials or tests).
- Once the web app displays the available classes, the user can filter based on desired faculties, online/on-campus, and desired course level.
- Users will be able to view all instructors teaching a specific course.

# For Developers
## To test the app locally
The README.txt of the backend and frontend repo shows the instruction to run the app.

## Database Creation
The queries for creating tables are located in the file /backend/database/createtables.sql.
The backend app will execute that sql file which creates the tables for the SQL database.

## Database Population
Using Google Cloud Shell and MySQL, the commands in /backend/database/sql/sampledataset.sql are executed manually.

## How the Web app receives data from the SQL database
The backend grabs the data from SQL database in gcp (via sqlalchemy) and sends that data to the web app whenever the webapp executes a GET request to the backend API (on /courses route).

## Web App link
https://cs348-webapp10.appspot.com/
Note: currently this does not work because our free trial for GCP expired.

## Backend API link
https://cs348-database10.appspot.com/courses
Note: currently this does not work because our free trial for GCP expired.

## How to populate local database with sample data

### For connecting to local database:

### Steps: 
`brew install postgresql`

`pg_ctl -D /usr/local/var/postgres start && brew services start postgresql`

`psql postgres`

Our database name is schedulemaker, type in this when posgres started:

postgres=# `CREATE DATABASE schedulemaker`


#### To run scripts for local database:

### You can try this:
python3 ./database/scripts/execute_sql.py -f createtables -u yourUsername -p yourPassword

### To Populate all data into local database:
python3 ./database/scripts/populate_tables.py -u yourUsername -p yourPassword

### To Populate specific table into local database:
python3 ./database/scripts/populate_tables.py -t 'table_you_want_to_populate' -u yourUsername -p yourPassword
